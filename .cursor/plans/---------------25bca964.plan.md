<!-- 25bca964-6b4d-4eba-bed7-054a39392123 00afb90e-2d21-4175-a516-de74b150f40f -->
# 시드 데이터 컨텍스트 구현 (1차 - 완전판)

## 1. 엔티티 의존성 분석 (완전한 맵퍼 포함)

### Phase 1: 기본 도메인 데이터 (Common)

1. **Department** (독립)
2. **Employee** (← Department)
3. **Project** (← Employee as manager, optional)
4. **WbsItem** (← Project, Employee as assignedTo)

### Phase 2: 평가 기간 및 대상자 (Core - Setup)

5. **EvaluationPeriod** (독립)
6. **EvaluationPeriodEmployeeMapping** (← EvaluationPeriod, Employee)

### Phase 3: 프로젝트 및 WBS 할당 (Core - Assignment)

7. **EvaluationProjectAssignment** (← EvaluationPeriod, Employee, Project)
8. **EvaluationWbsAssignment** (← EvaluationPeriod, Employee, Project, WbsItem)

### Phase 4: 평가 기준 및 라인 (Core - Criteria)

9. **WbsEvaluationCriteria** (← WbsItem)
10. **EvaluationLine** (독립 - 평가 라인 템플릿)
11. **EvaluationLineMapping** (← EvaluationLine, Employee, WbsItem optional)

### Phase 5: 산출물 (Core - Deliverable)

12. **Deliverable** (← WbsItem, Employee)
13. **DeliverableMapping** (← Deliverable, WbsItem, Employee)

### Phase 6: 질문 그룹 및 질문 (Sub - Questions)

14. **QuestionGroup** (독립)
15. **EvaluationQuestion** (독립)
16. **QuestionGroupMapping** (← QuestionGroup, EvaluationQuestion)

### Phase 7: 평가 실행 (Core - Evaluations)

17. **WbsSelfEvaluation** (← WbsItem, Employee, EvaluationPeriod)
18. **DownwardEvaluation** (← Employee, EvaluationPeriod, Project, WbsSelfEvaluation optional)
19. **PeerEvaluation** (← Employee, EvaluationPeriod)
20. **PeerEvaluationQuestionMapping** (← PeerEvaluation, EvaluationQuestion, QuestionGroup optional)
21. **FinalEvaluation** (← Employee, EvaluationPeriod)

### Phase 8: 응답 (Sub - Responses)

22. **EvaluationResponse** (← EvaluationQuestion, 각종 Evaluation entities)

## 2. 1차 구현 시나리오 (5단계 세분화)

### Scenario 1: MINIMAL

**Phase 1만 실행** - Department, Employee, Project, WbsItem

### Scenario 2: WITH_PERIOD

**Phase 1-2 실행** - MINIMAL + EvaluationPeriod, EvaluationPeriodEmployeeMapping

### Scenario 3: WITH_ASSIGNMENTS

**Phase 1-3 실행** - WITH_PERIOD + EvaluationProjectAssignment, EvaluationWbsAssignment

### Scenario 4: WITH_SETUP

**Phase 1-6 실행** - WITH_ASSIGNMENTS + WbsEvaluationCriteria, EvaluationLine, Deliverable, QuestionGroup

### Scenario 5: FULL

**Phase 1-8 전체 실행** - WITH_SETUP + 모든 평가 실행 데이터

## 3. 컨텍스트 구조

```
src/context/seed-data-context/
├── seed-data-context.module.ts
├── seed-data.service.ts
├── interfaces/
│   └── seed-data-context.interface.ts
├── handlers/
│   ├── commands/
│   │   ├── generate-seed-data.command.ts
│   │   ├── clear-seed-data.command.ts
│   │   └── index.ts
│   ├── queries/
│   │   ├── get-seed-data-status.query.ts
│   │   └── index.ts
│   └── index.ts
├── generators/
│   ├── phase1-organization.generator.ts
│   ├── phase2-evaluation-period.generator.ts
│   ├── phase3-8-full-cycle.generator.ts
│   └── index.ts
├── utils/
│   ├── probability.util.ts          # 확률 기반 상태 결정 헬퍼
│   ├── date-generator.util.ts       # 날짜 생성 헬퍼
│   ├── score-generator.util.ts      # 점수 생성 헬퍼
│   └── index.ts
└── types/
    ├── seed-scenario.types.ts
    ├── seed-config.types.ts
    └── index.ts
```

## 4. 완전한 타입 정의

```typescript:src/context/seed-data-context/types/seed-scenario.types.ts
export enum SeedScenario {
  MINIMAL = 'minimal',
  WITH_PERIOD = 'with_period',
  WITH_ASSIGNMENTS = 'with_assignments',
  WITH_SETUP = 'with_setup',
  FULL = 'full',
}

export interface SeedDataConfig {
  scenario: SeedScenario;
  clearExisting: boolean;
  dataScale: {
    departmentCount: number;
    employeeCount: number;
    projectCount: number;
    wbsPerProject: number;
  };
  stateDistribution?: StateDistributionConfig;
}

export interface StateDistributionConfig {
  // === Phase 1: 조직 데이터 ===
  
  // 부서 계층 구조
  departmentHierarchy?: {
    maxDepth: number;              // 최대 깊이 (기본: 3)
    childrenPerParent: {
      min: number;                 // 최소 하위 부서 (기본: 0)
      max: number;                 // 최대 하위 부서 (기본: 3)
    };
    rootDepartmentRatio: number;   // 최상위 부서 비율 (기본: 0.20)
  };
  
  // 직원 상태 분포
  employeeStatus?: {
    active: number;                // 재직중 (기본: 0.85)
    onLeave: number;               // 휴직중 (기본: 0.05)
    resigned: number;              // 퇴사 (기본: 0.10)
  };
  
  // 프로젝트 상태 분포
  projectStatus?: {
    active: number;                // 진행중 (기본: 0.70)
    completed: number;             // 완료 (기본: 0.25)
    cancelled: number;             // 취소 (기본: 0.05)
  };
  
  // 프로젝트 매니저 할당 비율
  projectManagerAssignmentRatio?: number;  // (기본: 0.95)
  
  // WBS 계층 구조
  wbsHierarchy?: {
    maxDepth: number;              // 최대 깊이 (기본: 3)
    childrenPerParent: {
      min: number;                 // 최소 하위 WBS (기본: 0)
      max: number;                 // 최대 하위 WBS (기본: 4)
    };
  };
  
  // WBS 상태 분포
  wbsStatus?: {
    pending: number;               // 대기 (기본: 0.20)
    inProgress: number;            // 진행중 (기본: 0.60)
    completed: number;             // 완료 (기본: 0.20)
  };
  
  // WBS 담당자 할당 비율
  wbsAssignmentRatio?: number;     // (기본: 0.90)
  
  // === Phase 2: 평가기간 ===
  
  // 평가기간 상태 분포
  evaluationPeriodStatus?: {
    waiting: number;               // 대기 (기본: 0.20)
    inProgress: number;            // 진행중 (기본: 0.70)
    completed: number;             // 완료 (기본: 0.10)
  };
  
  // 평가기간 현재 단계 분포 (inProgress일 때만 적용)
  evaluationPeriodPhase?: {
    evaluationSetup: number;       // 평가설정 (기본: 0.20)
    performance: number;           // 업무수행 (기본: 0.20)
    selfEvaluation: number;        // 자기평가 (기본: 0.25)
    peerEvaluation: number;        // 하향/동료평가 (기본: 0.25)
    closure: number;               // 종결 (기본: 0.10)
  };
  
  // 평가 대상 제외 비율
  excludedFromEvaluation?: number;  // (기본: 0.05)
  
  // === Phase 4: 평가 기준 및 라인 ===
  
  // WBS당 평가기준 개수
  wbsCriteriaPerWbs?: {
    min: number;                   // 최소 (기본: 2)
    max: number;                   // 최대 (기본: 5)
  };
  
  // 평가 라인 생성 수
  evaluationLineCount?: {
    primary: number;               // 주평가자 라인 (기본: 1)
    secondary: number;             // 부평가자 라인 (기본: 1)
    additionalMin: number;         // 추가평가자 라인 최소 (기본: 0)
    additionalMax: number;         // 추가평가자 라인 최대 (기본: 2)
  };
  
  // 평가 라인 매핑 비율 (직원별)
  evaluationLineMappingTypes?: {
    primaryOnly: number;           // 1차만 (기본: 0.30)
    primaryAndSecondary: number;   // 1,2차 (기본: 0.50)
    withAdditional: number;        // 추가 평가 포함 (기본: 0.20)
  };
  
  // === Phase 5: 산출물 ===
  
  // WBS당 산출물 개수 분포
  deliverablePerWbs?: {
    none: number;                  // 없음 (기본: 0.15)
    one: number;                   // 1개 (기본: 0.30)
    twoToThree: number;            // 2-3개 (기본: 0.40)
    fourOrMore: number;            // 4개 이상 (기본: 0.15)
  };
  
  // 산출물 타입 분포
  deliverableType?: {
    url: number;                   // URL 타입 (기본: 0.60)
    nas: number;                   // NAS 타입 (기본: 0.40)
  };
  
  // === Phase 6: 질문 그룹 및 질문 ===
  
  // 질문 그룹 생성 수
  questionGroupCount?: {
    min: number;                   // 최소 (기본: 3)
    max: number;                   // 최대 (기본: 8)
  };
  
  // 질문 그룹 특수 속성
  questionGroupSpecial?: {
    defaultGroupRatio: number;     // 기본 그룹 비율 (기본: 0.30)
    nonDeletableRatio: number;     // 삭제 불가 그룹 비율 (기본: 0.40)
  };
  
  // 그룹당 평가 질문 수
  questionsPerGroup?: {
    min: number;                   // 최소 (기본: 3)
    max: number;                   // 최대 (기본: 10)
  };
  
  // 평가 질문 유형 분포
  questionType?: {
    scoreOnly: number;             // 점수만 (기본: 0.40)
    textOnly: number;              // 서술형만 (기본: 0.30)
    scoreAndText: number;          // 점수+서술형 (기본: 0.30)
  };
  
  // 질문이 속하는 그룹 수 분포
  questionGroupMappingRatio?: {
    singleGroup: number;           // 1개 그룹만 (기본: 0.60)
    twoGroups: number;             // 2개 그룹 (기본: 0.30)
    threeOrMore: number;           // 3개 이상 (기본: 0.10)
  };
  
  // === Phase 7: 평가 실행 ===
  
  // 자기평가 진행 상태
  selfEvaluationProgress?: {
    notStarted: number;            // 미작성 (기본: 0.15)
    inProgress: number;            // 진행중 (기본: 0.25)
    completed: number;             // 완료 (기본: 0.60)
  };
  
  // 하향평가 진행 상태
  downwardEvaluationProgress?: {
    notStarted: number;            // 미작성 (기본: 0.20)
    inProgress: number;            // 진행중 (기본: 0.30)
    completed: number;             // 완료 (기본: 0.50)
  };
  
  // 하향평가 평가자 구성
  downwardEvaluationTypes?: {
    primaryOnly: number;           // 1차만 (기본: 0.20)
    secondaryOnly: number;         // 2차만 (기본: 0.10)
    both: number;                  // 1,2차 모두 (기본: 0.70)
  };
  
  // 하향평가 자기평가 참조 비율
  downwardEvaluationSelfReference?: number;  // (기본: 0.80)
  
  // 동료평가 진행 상태
  peerEvaluationProgress?: {
    notStarted: number;            // 미작성 (기본: 0.25)
    inProgress: number;            // 진행중 (기본: 0.35)
    completed: number;             // 완료 (기본: 0.40)
  };
  
  // 동료평가자 수 분포
  peerEvaluatorCount?: {
    one: number;                   // 1명 (기본: 0.20)
    two: number;                   // 2명 (기본: 0.40)
    three: number;                 // 3명 (기본: 0.30)
    fourOrMore: number;            // 4명 이상 (기본: 0.10)
  };
  
  // 동료평가에 질문 할당 비율
  peerEvaluationQuestionAssignment?: {
    noQuestions: number;           // 질문 없음 (기본: 0.10)
    oneGroup: number;              // 1개 그룹 (기본: 0.30)
    twoGroups: number;             // 2개 그룹 (기본: 0.40)
    threeOrMore: number;           // 3개 이상 그룹 (기본: 0.20)
  };
  
  // 최종평가 진행 상태
  finalEvaluationProgress?: {
    notStarted: number;            // 미작성 (기본: 0.40)
    inProgress: number;            // 진행중 (기본: 0.20)
    completed: number;             // 완료 (기본: 0.40)
  };
  
  // 평가 점수 생성 규칙
  scoreGeneration?: {
    min: number;                   // 최소 점수 (기본: 60)
    max: number;                   // 최대 점수 (기본: 100)
    distribution: 'normal' | 'uniform';  // 분포 방식 (기본: 'normal')
    mean?: number;                 // 정규분포 평균 (기본: 80)
    stdDev?: number;               // 정규분포 표준편차 (기본: 10)
  };
  
  // === Phase 8: 응답 ===
  
  // 평가 응답 생성 비율
  evaluationResponseRatio?: {
    noResponse: number;            // 응답 없음 (기본: 0.10)
    hasResponse: number;           // 응답 있음 (기본: 0.90)
  };
  
  // === 날짜 생성 규칙 ===
  
  dateGeneration?: {
    evaluationPeriod: {
      durationMonths: {
        min: number;               // 최소 기간 (기본: 6)
        max: number;               // 최대 기간 (기본: 12)
      };
      phaseGapDays: number;        // 단계 간 간격 (기본: 7)
    };
    project: {
      durationMonths: {
        min: number;               // 최소 기간 (기본: 3)
        max: number;               // 최대 기간 (기본: 12)
      };
    };
    wbs: {
      durationDays: {
        min: number;               // 최소 기간 (기본: 7)
        max: number;               // 최대 기간 (기본: 90)
      };
    };
  };
}

// Generator 공통 결과 타입
export interface GeneratorResult {
  phase: string;
  entityCounts: Record<string, number>;
  generatedIds: Record<string, string[]>;
  stateDistribution?: Record<string, Record<string, number>>;
  duration: number;
  errors?: string[];
}
```



```typescript:src/context/seed-data-context/types/seed-config.types.ts
export const DEFAULT_STATE_DISTRIBUTION: Required<StateDistributionConfig> = {
  // Phase 1
  departmentHierarchy: {
    maxDepth: 3,
    childrenPerParent: { min: 0, max: 3 },
    rootDepartmentRatio: 0.20,
  },
  employeeStatus: { active: 0.85, onLeave: 0.05, resigned: 0.10 },
  projectStatus: { active: 0.70, completed: 0.25, cancelled: 0.05 },
  projectManagerAssignmentRatio: 0.95,
  wbsHierarchy: {
    maxDepth: 3,
    childrenPerParent: { min: 0, max: 4 },
  },
  wbsStatus: { pending: 0.20, inProgress: 0.60, completed: 0.20 },
  wbsAssignmentRatio: 0.90,
  
  // Phase 2
  evaluationPeriodStatus: { waiting: 0.20, inProgress: 0.70, completed: 0.10 },
  evaluationPeriodPhase: {
    evaluationSetup: 0.20,
    performance: 0.20,
    selfEvaluation: 0.25,
    peerEvaluation: 0.25,
    closure: 0.10,
  },
  excludedFromEvaluation: 0.05,
  
  // Phase 4
  wbsCriteriaPerWbs: { min: 2, max: 5 },
  evaluationLineCount: { primary: 1, secondary: 1, additionalMin: 0, additionalMax: 2 },
  evaluationLineMappingTypes: { primaryOnly: 0.30, primaryAndSecondary: 0.50, withAdditional: 0.20 },
  
  // Phase 5
  deliverablePerWbs: { none: 0.15, one: 0.30, twoToThree: 0.40, fourOrMore: 0.15 },
  deliverableType: { url: 0.60, nas: 0.40 },
  
  // Phase 6
  questionGroupCount: { min: 3, max: 8 },
  questionGroupSpecial: { defaultGroupRatio: 0.30, nonDeletableRatio: 0.40 },
  questionsPerGroup: { min: 3, max: 10 },
  questionType: { scoreOnly: 0.40, textOnly: 0.30, scoreAndText: 0.30 },
  questionGroupMappingRatio: { singleGroup: 0.60, twoGroups: 0.30, threeOrMore: 0.10 },
  
  // Phase 7
  selfEvaluationProgress: { notStarted: 0.15, inProgress: 0.25, completed: 0.60 },
  downwardEvaluationProgress: { notStarted: 0.20, inProgress: 0.30, completed: 0.50 },
  downwardEvaluationTypes: { primaryOnly: 0.20, secondaryOnly: 0.10, both: 0.70 },
  downwardEvaluationSelfReference: 0.80,
  peerEvaluationProgress: { notStarted: 0.25, inProgress: 0.35, completed: 0.40 },
  peerEvaluatorCount: { one: 0.20, two: 0.40, three: 0.30, fourOrMore: 0.10 },
  peerEvaluationQuestionAssignment: { noQuestions: 0.10, oneGroup: 0.30, twoGroups: 0.40, threeOrMore: 0.20 },
  finalEvaluationProgress: { notStarted: 0.40, inProgress: 0.20, completed: 0.40 },
  scoreGeneration: { min: 60, max: 100, distribution: 'normal', mean: 80, stdDev: 10 },
  
  // Phase 8
  evaluationResponseRatio: { noResponse: 0.10, hasResponse: 0.90 },
  
  // 날짜 생성
  dateGeneration: {
    evaluationPeriod: {
      durationMonths: { min: 6, max: 12 },
      phaseGapDays: 7,
    },
    project: {
      durationMonths: { min: 3, max: 12 },
    },
    wbs: {
      durationDays: { min: 7, max: 90 },
    },
  },
};
```

## 5. Utils 구현

```typescript:src/context/seed-data-context/utils/probability.util.ts
// 확률 기반 상태 결정 헬퍼
export class ProbabilityUtil {
  /**
   * 확률 분포에서 하나를 선택
   */
  static selectByProbability<T extends Record<string, number>>(
    distribution: T
  ): keyof T {
    const random = Math.random();
    let cumulative = 0;
    
    for (const [key, probability] of Object.entries(distribution)) {
      cumulative += probability;
      if (random < cumulative) {
        return key;
      }
    }
    
    return Object.keys(distribution)[0];
  }
  
  /**
   * 비율 분포 유효성 검증 (합계 1.0 체크)
   */
  static validateDistribution(distribution: Record<string, number>): void {
    const sum = Object.values(distribution).reduce((a, b) => a + b, 0);
    if (Math.abs(sum - 1.0) > 0.001) {
      throw new Error(`분포 비율의 합이 1.0이 아닙니다: ${sum}`);
    }
  }
}
```



```typescript:src/context/seed-data-context/utils/score-generator.util.ts
// 점수 생성 헬퍼
export class ScoreGeneratorUtil {
  /**
   * 정규분포 점수 생성
   */
  static generateNormalScore(
    min: number,
    max: number,
    mean: number,
    stdDev: number
  ): number {
    // Box-Muller 변환
    const u1 = Math.random();
    const u2 = Math.random();
    const z = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
    const score = mean + z * stdDev;
    
    return Math.max(min, Math.min(max, Math.round(score)));
  }
  
  /**
   * 균등분포 점수 생성
   */
  static generateUniformScore(min: number, max: number): number {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }
}
```



```typescript:src/context/seed-data-context/utils/date-generator.util.ts
// 날짜 생성 헬퍼
export class DateGeneratorUtil {
  /**
   * 랜덤 날짜 범위 생성
   */
  static generateDateRange(
    startFrom: Date,
    minDuration: number,
    maxDuration: number,
    unit: 'days' | 'months'
  ): { startDate: Date; endDate: Date } {
    const duration = Math.floor(
      Math.random() * (maxDuration - minDuration + 1)
    ) + minDuration;
    
    const startDate = new Date(startFrom);
    const endDate = new Date(startDate);
    
    if (unit === 'days') {
      endDate.setDate(endDate.getDate() + duration);
    } else {
      endDate.setMonth(endDate.getMonth() + duration);
    }
    
    return { startDate, endDate };
  }
}
```

## 6. Generator 구현 방식

```typescript
@Injectable()
export class Phase1OrganizationGenerator {
  constructor(private readonly probabilityUtil: ProbabilityUtil) {}
  
  async generate(config: SeedDataConfig): Promise<GeneratorResult> {
    // Department → Employee → Project → WbsItem 순차 생성
    // 계층 구조, 상태 분포 모두 적용
  }
}

@Injectable()
export class Phase2EvaluationPeriodGenerator {
  async generate(
    config: SeedDataConfig,
    phase1Result: GeneratorResult
  ): Promise<GeneratorResult> {
    // EvaluationPeriod → EvaluationPeriodEmployeeMapping 생성
    // 날짜 생성 규칙 적용
  }
}

@Injectable()
export class Phase3To8FullCycleGenerator {
  async generate(
    config: SeedDataConfig,
    phase1Result: GeneratorResult,
    phase2Result: GeneratorResult
  ): Promise<GeneratorResult> {
    // 시나리오별 Phase 실행
  }
  
  private shouldRunPhase(phase: number, scenario: SeedScenario): boolean {
    const phaseMap = {
      [SeedScenario.MINIMAL]: 0,
      [SeedScenario.WITH_PERIOD]: 0,
      [SeedScenario.WITH_ASSIGNMENTS]: 3,
      [SeedScenario.WITH_SETUP]: 6,
      [SeedScenario.FULL]: 8,
    };
    return phase <= phaseMap[scenario];
  }
}
```

## 7. 데이터 삭제 전략

```typescript:src/context/seed-data-context/handlers/commands/clear-seed-data.command.ts
// clearPhase 메서드는 command handler에 구현
@Injectable()
@CommandHandler(ClearSeedDataCommand)
export class ClearSeedDataHandler {
  async clearData(scenario: SeedScenario): Promise<void> {
    // 시나리오별 역순 삭제
    // Phase 8 → 1 순으로 clearPhaseX() 호출
  }
  
  private async clearPhase1(): Promise<void> { /* WbsItem, Project, Employee, Department */ }
  private async clearPhase2(): Promise<void> { /* EvaluationPeriodEmployeeMapping, EvaluationPeriod */ }
  // ... Phase 8까지
}
```

## 8. API 엔드포인트

```typescript:src/interface/admin/seed-data/seed-data.controller.ts
@Controller('admin/seed')
export class SeedDataController {
  @Post('generate')
  async generateSeedData(@Body() config: SeedDataConfigDto): Promise<SeedDataResultDto>
  
  @Delete('clear')
  async clearSeedData(@Query() query: ClearSeedDataQueryDto): Promise<void>
  
  @Get('status')
  async getSeedDataStatus(): Promise<SeedDataStatusDto>
}
```

## 9. 1차 구현 파일 목록 (최종)

### Context 파일 (13개)

1. `seed-data-context.module.ts`
2. `seed-data.service.ts`
3. `interfaces/seed-data-context.interface.ts`
4. `types/seed-scenario.types.ts`
5. `types/seed-config.types.ts`
6. `generators/phase1-organization.generator.ts`
7. `generators/phase2-evaluation-period.generator.ts`
8. `generators/phase3-8-full-cycle.generator.ts`
9. `utils/probability.util.ts`
10. `utils/date-generator.util.ts`
11. `utils/score-generator.util.ts`
12. `handlers/commands/generate-seed-data.command.ts`
13. `handlers/commands/clear-seed-data.command.ts`
14. `handlers/queries/get-seed-data-status.query.ts`

### Interface 파일 (4개)

15. `interface/admin/seed-data/seed-data.controller.ts`
16. `interface/admin/seed-data/dto/seed-data-config.dto.ts`
17. `interface/admin/seed-data/dto/seed-data-result.dto.ts`
18. `interface/admin/seed-data/decorators/seed-data.decorators.ts`

**총 18개 파일**

## 10. 데이터 생성 규칙

### faker.js 사용 규칙

```typescript
import { faker } from '@faker-js/faker';

// 한글 로케일 설정
faker.locale = 'ko';

// 사용 예시
const departmentName = faker.commerce.department();  // "개발팀", "마케팅팀" 등
const employeeName = faker.person.fullName();        // "김철수", "이영희" 등
const projectName = faker.company.catchPhrase();     // "혁신적인 솔루션 개발" 등
const email = faker.internet.email();                // "test@example.com"
const phoneNumber = faker.phone.number('010-####-####');  // "010-1234-5678"
const url = faker.internet.url();                    // "https://example.com"
const nasPath = `/nas/project/${faker.string.uuid()}/file.pdf`;
const description = faker.lorem.paragraph();         // 설명 텍스트
```

### 배치 처리 규칙

```typescript
// 배치 insert 크기 설정
const BATCH_SIZE = 500;  // 엔티티 500개씩 배치 처리

// 사용 예시
async function createEmployeesInBatch(employees: Employee[]): Promise<void> {
  for (let i = 0; i < employees.length; i += BATCH_SIZE) {
    const batch = employees.slice(i, i + BATCH_SIZE);
    await this.employeeRepository.save(batch);
    
    // 진행 상황 로그
    this.logger.log(`직원 생성 진행: ${Math.min(i + BATCH_SIZE, employees.length)}/${employees.length}`);
  }
}
```

### Phase별 생성 순서 상세

#### Phase 1 내부 순서:

```typescript
// 1. Department 계층 생성
//    1-1. 최상위 Department (rootDepartmentRatio 기준)
//    1-2. 2레벨 Department (childrenPerParent 기준)
//    1-3. 3레벨 Department (maxDepth까지)
//    
// 2. Employee 생성 (Department에 랜덤 할당)
//
// 3. Project 생성
//    3-1. manager로 Employee 할당 (projectManagerAssignmentRatio)
//
// 4. WbsItem 계층 생성 (프로젝트별)
//    4-1. 최상위 WbsItem (wbsPerProject 기준)
//    4-2. 하위 WbsItem (childrenPerParent, maxDepth)
//    4-3. assignedTo로 Employee 할당 (wbsAssignmentRatio)
```

## 11. 핵심 고려사항

- **트랜잭션**: Phase별 트랜잭션 처리
- **외래키 제약**: Phase 순서 엄격 준수
- **실제 데이터**: faker.js 한글 로케일 활용
- **성능**: 배치 insert (500개 단위)
- **진행 표시**: Phase별 진행률 로그
- **에러 처리**: Phase 단위 롤백
- **상태 다양성**: 확률 기반 분포 생성
- **계층 구조**: Department, WbsItem 계층 지원
- **날짜 일관성**: 합리적인 날짜 범위 생성
- **점수 분포**: 정규분포/균등분포 지원
- **비율 검증**: 모든 분포 비율 합계 1.0 검증

## 11. 참고 파일

- 기존 컨텍스트 구조: `src/context/evaluation-period-management-context/`
- CQRS 패턴: `src/context/AGENTS.md`
- 엔티티 정의: `src/domain/`

### To-dos

- [ ] 도메인 엔티티 간 의존성 완전 분석 및 생성 순서 검증
- [ ] 시드 데이터 타입 정의 (시나리오, 설정, 결과)
- [ ] 컨텍스트 인터페이스 정의
- [ ] 각 도메인별 데이터 생성기 구현
- [ ] Command/Query 핸들러 구현
- [ ] 시드 데이터 서비스 파사드 구현
- [ ] 컨텍스트 모듈 구현
- [ ] Admin API 컨트롤러 구현
- [ ] API DTO 및 데코레이터 구현
- [ ] 메인 모듈에 시드 데이터 컨텍스트 통합